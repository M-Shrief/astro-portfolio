---
import { getCollection } from "astro:content";
// Layouts
import Layout from "../../layouts/MainLayout.astro";
// Components
import BlogCard from "../../components/blogCard.astro";
// Utils
import {getAllClassifications, getClassificationsList} from '../../utils/blog'

const posts = (await getCollection("blog", ({data}) => {
  return import.meta.env.PROD ? data.isDraft !== true : true;
})).sort(
  (a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf() 
);

// const allCategories = await getClassificationsList("categories")
// const allBlogsCategories = await getAllClassifications("categories") 
// const allTags = await getClassificationsList("tags")
// const allBlogsTags = await getAllClassifications("tags")

---

<Layout title="M. Shrief :: Blog" description="Blogs about Web development in the Backend and Frontend.">
  <main>
    <section >
      <h1>Blogs</h2>

      <ul >
        {
          posts.map((post) => (
            <BlogCard slug={post.slug} title={post.data.title} description={post.data.description}
             pubDate={post.data.pubDate} tags={post.data.tags} categories={post.data.categories} />
          ))
        }
      </ul>
    </section>
  </main>
</Layout>

<style lang="scss">
  @import "../../assets/mixins.scss";
  main {
    width: 80%;
    margin: 1rem auto;
    @include mQ($breakpoint-sm) {
      width: 95%;
      h1 {
        font-size: 1.4rem;
      }
    }
  }
</style>

